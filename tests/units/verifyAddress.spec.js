import { decodePayment } from 'dist/esm'

describe('verifies address', () => {

  const validExamples = {
    'arbitrum': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    '0xa4b1': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    '42161': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    'avalanche': '0x39E7C98BF4ac3E4C394dD600397f5f7Ee3779BE8',
    '0xa86a': '0x39E7C98BF4ac3E4C394dD600397f5f7Ee3779BE8',
    '43114': '0x39E7C98BF4ac3E4C394dD600397f5f7Ee3779BE8',
    'base': '0x48825133EF08327535D0b24d73779E82BE6Ea4d9',
    '0x2105': '0x48825133EF08327535D0b24d73779E82BE6Ea4d9',
    '8453': '0x48825133EF08327535D0b24d73779E82BE6Ea4d9',
    'bsc': '0x5F565EDfB9C446976a9F9910631cfeDb6A87220c',
    '0x38': '0x5F565EDfB9C446976a9F9910631cfeDb6A87220c',
    '56': '0x5F565EDfB9C446976a9F9910631cfeDb6A87220c',
    'ethereum': '0x365f7B56D2fB16C8Af89D7d33b420E4e013461e8',
    '0x1': '0x365f7B56D2fB16C8Af89D7d33b420E4e013461e8',
    '1': '0x365f7B56D2fB16C8Af89D7d33b420E4e013461e8',
    'gnosis': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    '0x64': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    '100': '0x328FE8bbd30487BB7b5A8eEb909f892E9E229271',
    'optimism': '0x558302715e3011Be6695605c11A65526D2ba2245',
    '0xa': '0x558302715e3011Be6695605c11A65526D2ba2245',
    '10': '0x558302715e3011Be6695605c11A65526D2ba2245',
    'polygon': '0xe04b08Dfc6CaA0F4Ec523a3Ae283Ece7efE00019',
    '0x89': '0xe04b08Dfc6CaA0F4Ec523a3Ae283Ece7efE00019',
    '137': '0xe04b08Dfc6CaA0F4Ec523a3Ae283Ece7efE00019',
    'worldchain': '0x886eb82a7e5E7310F66A0E83748662A17E391eb0',
    '0x1e0': '0x886eb82a7e5E7310F66A0E83748662A17E391eb0',
    '480': '0x886eb82a7e5E7310F66A0E83748662A17E391eb0',
    'solana': 'DePayR1gQfDmViCPKctnZXNtUgqRwnEqMax8LX9ho1Zg',
  }

  for (const key in validExamples) {

    it(`verifies valid address for ${key}`, ()=> {
      expect(
        decodePayment({
          blockchain: key,
          address: validExamples[key],
          transaction: '0xcac7130c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000017508f1956a80000000000000000000000000000000000000000000000000000000000000005de200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016e000000000000000000000000000000000000000000000000000001970d6e3d40000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000068b3465833fb72a70ecdf485e0e4c7bd8665fc450000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c335900000000000000000000000008b277154218ccf3380cae48d630da13462e395000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000004e00000000000000000000000000000000000000000000000000000000000000284ac9650d800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000241c58db4f00000000000000000000000000000000000000000000000001732c47109514d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104b858183f00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f50000000000000000000000000000000000000000000000000000000000000002b0d500b1d8e8ef31e21c99d1db9a6444d3adf12700001f43c499c542cef5e3811e1192ce70d8cc03d5c335900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000412210e8a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000'
        })
      ).not.toEqual(undefined)
    })
  }

  it(`flags invalid addresses as invalid`, ()=>{

    expect(
      decodePayment({
        blockchain: 'ethereum',
        address: '0x123',
        transaction: '0xcac7130c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000017508f1956a80000000000000000000000000000000000000000000000000000000000000005de200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016e000000000000000000000000000000000000000000000000000001970d6e3d40000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee00000000000000000000000068b3465833fb72a70ecdf485e0e4c7bd8665fc450000000000000000000000003c499c542cef5e3811e1192ce70d8cc03d5c335900000000000000000000000008b277154218ccf3380cae48d630da13462e395000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000004e00000000000000000000000000000000000000000000000000000000000000284ac9650d800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000241c58db4f00000000000000000000000000000000000000000000000001732c47109514d0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000104b858183f00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005f50000000000000000000000000000000000000000000000000000000000000002b0d500b1d8e8ef31e21c99d1db9a6444d3adf12700001f43c499c542cef5e3811e1192ce70d8cc03d5c335900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000412210e8a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000'
      })
    ).toEqual(undefined)
  })
})
